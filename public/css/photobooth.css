:root {
    --navbar-height: 56px;
}

.container {
    text-align: center;
    box-sizing: border-box;
}

video {
    border: 2px solid #333;
    width: 100%;
    height: auto;
    max-width: 100%;
    display: block;
}

.photo.selected img {
    box-shadow:
        0 0 0 2px rgba(13,110,253,.6),
        0 0 12px 6px rgba(13,110,253,.55);
}

.controls {
    margin-top: 10px;
}

.controls input {
    padding: 5px;
    width: 100px;
}

.controls.button {
    padding: 10px 20px;
    cursor: pointer;
}

#photos {
    display: flex;
    flex-wrap: wrap;
    margin-top: 20px;
}

.photo {
    margin: 10px;
    position: relative;
}

.photo img {
    width: 90%;
    height: auto;
    border: 2px solid #333;
}

.photo button {
    position: absolute;
    bottom: 5px;
    left: 27.5%;
    padding: 5px;
    cursor: pointer;
}

.photo input[type="checkbox"] {
    position: absolute;
    top: 10px;
    left: 35px;
    transform: scale(1.5);
}

/* Video capture card - fixed height */
#video-capture-card {
    display: flex;
    flex-direction: column;
    height: fit-content;
}

#video-display {
    flex-shrink: 0;
}

.booth {
    width: 100%;
    aspect-ratio: 9 / 6 auto;
    overflow: hidden;
    background: #000;
}

video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Gallery card - max height with scrolling */
#captured-photo-list {
    display: flex;
    flex-direction: column;
    height: fit-content;
    max-height: calc(100vh - 250px);
}

#captured-photo-list .card-body {
    display: flex;
    flex-direction: column;
    flex: 1;
    overflow: hidden;
}

.gallery {
    flex: 1;
    overflow-y: auto;
    max-height: none !important;
}

/* Gallery cards - equal height in rows */
.row .card {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.row .card-body {
    display: flex;
    flex-direction: column;
    flex-grow: 1;
}

.comment-preview,
.comment-display {
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    word-wrap: break-word;
    flex-grow: 1;
}

/* New form card - display full without scrolling */
.mb-3.col .card {
    display: flex;
    flex-direction: column;
    height: auto;
}

.mb-3.col .card-body {
    display: flex;
    flex-direction: column;
}

/* Mobile responsive styles */
@media (max-width: 768px) {
    /* Reduce top/bottom padding on mobile for index page */
    .container.px-3.pt-5 {
        padding-top: 0.5rem !important;
        padding-bottom: 0.25rem !important;
        
    }
    
    .row.g-3 {
        row-gap: 0.5rem !important;
    }
    
    .booth {
        width: 100%;
        aspect-ratio: 4 / 3;
    }
    
    video {
        max-height: 50vh;
        object-fit: cover;
    }
    
    #captured-photo-list {
        max-height: calc(100vh - 200px);
    }
    
    .photo img {
        width: 100%;
    }
    
    .photo button {
        left: 0;
        right: 0;
        margin: 0 auto;
        width: fit-content;
    }
}

/* New photo entry card - fit between header and footer */
#new-photo-entry {
    max-height: calc(100vh - 200px);
    overflow-y: auto;
}

#new-photo-entry .card-body {
    padding: 1rem;
}

#new-photo-entry img {
    max-height: 50vh;
    width: auto;
    object-fit: contain;
}

#new-photo-entry .mb-3,
#new-photo-entry .mb-4 {
    margin-bottom: 0.75rem !important;
}

#new-photo-entry .border-bottom {
    margin-bottom: 0.75rem !important;
    padding-top: 0.5rem !important;
    padding-bottom: 0.5rem !important;
}

/* Mobile adjustments for new photo entry */
@media (max-width: 768px) {
    #new-photo-entry {
        max-height: calc(100vh - 150px);
    }
    
    #new-photo-entry img {
        max-height: 35vh;
    }
}

/* Mobile sticky action bar */
.action-bar {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 10px;
  background: rgba(255,255,255,0.96);
  border-top: 1px solid rgba(0,0,0,.08);
  padding-bottom: calc(10px + env(safe-area-inset-bottom));
  z-index: 9999;
}

.action-bar-inner {
  display: grid;
  gap: 8px;
 grid-template-columns: repeat(3, 1fr);
}

.action-bar-inner .btn {
  width: 100%;
  min-width: 0;
  white-space: nowrap;
}

@media (max-width: 768px) {
  /* keep page content above the sticky bar */
  body { padding-bottom: 86px; }
}

@media (max-width: 768px){
  #uploadForm, #captured-photo-list, .gallery, #photos { display:none !important; }
  body{ overflow:hidden; }
}

/* ---- Fix mobile sticky controls + prevent overflow ---- */
.action-bar{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 10px;
  background: rgba(255,255,255,0.96);
  border-top: 1px solid rgba(0,0,0,.08);
  padding-bottom: calc(10px + env(safe-area-inset-bottom));
  z-index: 9999;
}
.action-bar-inner{
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  max-width: 900px;
  margin: 0 auto;
}
.action-bar-inner .btn{
  width: 100%;
  min-width: 0;
  white-space: nowrap;
  border-radius: 14px;
  padding: 12px 0;
}
@media (max-width: 768px){
  body{ padding-bottom: 86px; }
  #desktopControls{ display:none !important; }
  #video-capture-card{
    position: fixed;
    inset: 0;
    z-index: 10;
    border-radius: 0 !important;
    height: 100dvh;
  }
  #video-capture-card .card-body{
    height: calc(100dvh - 56px);
    display: flex;
    flex-direction: column;
  }
  .booth{ flex: 1; display:flex; overflow:hidden; }
  #video{ width:100%; height:100%; object-fit: cover; display:block; }
}
#photoFlowSheet.offcanvas-bottom{ height: min(92dvh, 760px); }
#photoFlowSheet .offcanvas-body{
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: calc(24px + env(safe-area-inset-bottom));
}


/* ===== Tweaks requested (phone UX) ===== */
@media (max-width: 768px){
  /* Make it feel like a camera app: remove site chrome */
  /* navbar visible */
/* Raise shutter a bit so it isn't on the very edge */
  .camera-dock{
    padding-bottom: calc(52px + env(safe-area-inset-bottom)) !important;
  }
}

/* Offcanvas: let the info form fit without hunting for Submit */
#photoFlowSheet.offcanvas-bottom{
  height: min(96dvh, 820px) !important;
}

#photoFlowSheet .offcanvas-body{
  padding-bottom: calc(30px + env(safe-area-inset-bottom)) !important;
}

/* Sticky submit inside the sheet */
#photoFlowSheet .sheet-submit{
  position: sticky;
  bottom: 0;
  background: #fff;
  padding: 12px 0 calc(12px + env(safe-area-inset-bottom));
  border-top: 1px solid rgba(0,0,0,.08);
}

/* When in info step, keep preview shorter so the form fits */
#photoFlowSheet.is-info #flowPreview{
  max-height: 35dvh !important;
  width: 100%;
  object-fit: cover;
}


/* ===== Camera overlay essentials ===== */
.camera-wrap{ position: relative; background:#000; }
.booth{ height: 100vh; background:#000; }
#video{ width:100%; height:100%; object-fit: cover; display:block; background:#000; }

@media (max-width:768px){
  .photobooth-page{ height: calc(100dvh - 56px); overflow:scroll; }
  .camera-wrap, .booth{ height: calc(100dvh - 56px); }

  .camera-topbar{
    position:absolute;
    top:calc(var(--navbar-height,56px) - 60px);
    z-index: 3;
    left: 0;
    right: 0;
    padding: 14px 14px 10px;
    display:flex;
    align-items:center;
    background: linear-gradient(to bottom, rgba(0,0,0,.65), rgba(0,0,0,0));
  }
  .camera-brand{ color:#fff; font-weight:700; letter-spacing:.2px; text-shadow: 0 1px 2px rgba(0,0,0,.45); }
  .camera-upload{
    margin-left:auto;
    border:1px solid rgba(255,255,255,.25);
    background: rgba(0,0,0,.25);
    color:#fff;
    border-radius:999px;
    padding:6px 12px;
    font-size: 14px;
  }

  .camera-upload:active{
  transform:scale(.95);
  background:rgba(0,0,0,.45);
}

  .camera-start-overlay{
    position:absolute;
    inset:0;
    padding-top:56px;
    z-index: 4;
    background: rgba(0,0,0,.55);
    display:grid;
    place-items:center;
    padding:20px;
    text-align:center;
  }
  .camera-start-overlay.is-hidden{ display:none; }

  .camera-dock{
    position:absolute;
    left:0; right:0; bottom:0;
    z-index:3;
    display:flex;
    justify-content:center;
    padding: 14px 16px calc(60px + env(safe-area-inset-bottom));
    background: linear-gradient(to top, rgba(0,0,0,.75), rgba(0,0,0,0));
  }
  .shutter{
    width:78px;height:78px;
    border-radius:999px;
    border:3px solid rgba(255,255,255,.95);
    background: rgba(255,255,255,.10);
    display:grid;
    place-items:center;
  }
  .shutter-inner{
    width:58px;height:58px;
    border-radius:999px;
    background: rgba(255,255,255,.92);
  }
  .shutter:disabled{ opacity:.5; }

  .capture-flash{
    position:absolute; inset:0;
    background:#fff; opacity:0;
    z-index:6; pointer-events:none;
  }
  .capture-flash.is-on{ animation: flash 220ms ease-out; }
  @keyframes flash{ 0%{opacity:0} 35%{opacity:.75} 100%{opacity:0} }
}

/* Bottom sheet tweaks */
#photoFlowSheet.offcanvas-bottom{ height: min(96dvh, 900px); }
#photoFlowSheet .offcanvas-body{
  overflow-y:auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: calc(18px + env(safe-area-inset-bottom));
}
#photoFlowSheet.is-info #previewWrap{ max-height: 30dvh; }
#photoFlowSheet.is-info #flowPreview{ max-height: 22dvh; object-fit: cover; width: 100%; }
.info-submit-bar{
  position: sticky;
  bottom: 0;
  background:#fff;
  /* less top padding -> button sits lower */
  padding: 4px 0 calc(8px + env(safe-area-inset-bottom));
  border-top: 1px solid rgba(0,0,0,.08);
}

#commentCount.warn {
  color: #dc3545;
  font-weight: 600;
}


/* ===== Desktop: make the mobile bottom sheet feel like a centered modal ===== */
@media (min-width: 768px){
  #photoFlowSheet.offcanvas-bottom{
    /* turn the bottom sheet into a centered dialog */
    top: 8vh;
    bottom: auto;
    left: 50%;
    transform: translateX(-50%);
    width: min(820px, 94vw);
    height: auto;
    max-height: 84vh;
    border-radius: 18px;
    box-shadow: 0 18px 60px rgba(0,0,0,.45);
  }

  #photoFlowSheet .offcanvas-header{
    position: sticky;
    top: 0;
    background: #fff;
    z-index: 2;
    border-top-left-radius: 18px;
    border-top-right-radius: 18px;
  }

  #photoFlowSheet .offcanvas-body{
    padding: 20px 22px;
    padding-bottom: 22px;
  }

  /* Better desktop preview sizing */
  #photoFlowSheet #flowPreview{
    width: 100%;
    max-height: 46vh;
    object-fit: cover;
  }

  /* Keep the sticky submit bar inside the modal */
  .info-submit-bar{
    padding: 8px 0 12px;
  }
}

